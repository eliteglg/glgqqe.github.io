<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–§–∞–π–ª—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è</title>
  <style>
    body { font-family: sans-serif; padding: 1em; background: #f9f9f9; }
    ul { list-style-type: none; padding-left: 1em; }
    li { margin: 4px 0; }
    .folder { font-weight: bold; }
    .zip-link { font-weight: normal; font-size: 0.9em; margin-left: 8px; }
  </style>
</head>
<body>
  <h1>üìÅ –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã</h1>
  <div id="tree">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
  <p><a href="https://github.com/glgqqe/glgqqe.github.io/archive/refs/heads/main.zip" download>‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å –≤–µ—Å—å —Å–∞–π—Ç (ZIP)</a></p>

<script>
const user = 'glgqqe';
const repo = 'glgqqe.github.io';
const branch = 'main';
const basePath = 'files';
const zipBasePath = 'zips';
const treeContainer = document.getElementById('tree');

function buildTree(paths) {
  const root = {};
  for (const path of paths) {
    const parts = path.split('/');
    let current = root;
    for (let i = 0; i < parts.length; i++) {
      const part = parts[i];
      if (!current[part]) current[part] = {};
      current = current[part];
    }
  }
  return root;
}

function renderTree(tree, prefix = '') {
  let html = '<ul>';
  for (const key of Object.keys(tree).sort()) {
    const fullPath = prefix ? `${prefix}/${key}` : key;
    if (Object.keys(tree[key]).length > 0) {
      const zipLink = `<a class="zip-link" href="${zipBasePath}/${fullPath}.zip" download>[ZIP]</a>`;
      html += `<li class="folder">üìÅ ${key} ${zipLink}${renderTree(tree[key], fullPath)}</li>`;
    } else {
      const url = `${basePath}/${fullPath}`;
      html += `<li>üìÑ <a href="${url}" download>${key}</a></li>`;
    }
  }
  html += '</ul>';
  return html;
}

async function fetchFileTree() {
  const res = await fetch(`https://api.github.com/repos/${user}/${repo}/git/trees/${branch}?recursive=1`);
  const data = await res.json();
  const filePaths = data.tree
    .filter(f => f.type === 'blob' && f.path.startsWith(basePath + '/'))
    .map(f => f.path.substring(basePath.length + 1));
  const tree = buildTree(filePaths);
  treeContainer.innerHTML = renderTree(tree);
}

fetchFileTree();
</script>
</body>
</html>
